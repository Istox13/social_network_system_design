# System Design социальной сети для курса по [System Design](https://balun.courses/courses/system_design)

## Функциональных требования
- Просмотр лент с обновлениями пользователей
- Подписка на/Отписка от пользователей
- Создание постов с фотографиями, небольшим описанием и привязкой к геопозиции
- Оценка и комментарии постов других пользователей
- Общение пользователей в приватных сообщениях
- Удаление постов
- Система оценки
  - Лайки 
- Поиск:
  - Поиск по городу/стране
  - Ранжирование постов по количеству оценок и по показателю week-to-week

## Нефункциональных требования

- DAU: `10 000 000`
- Availability >= `99,95%`
- Платформы:
  - IOS
  - Android 
  - Web
  - Mobile Web
- Аудитория: `СНГ`
- Обладает сезонностью с июля по октябрь (сезон отпусков)
- Максимальное время ответа сервера на запрос пользователя `1s`
- Время загрузки страницы должно быть не более `2s` на веб и `3s` на мобильных устройствах
- Данные хранятся всегда
  - При удалении используем soft-delete и храним такие данные 3 года (пакет Яровой)

- Обработки и хранения изображений:
  - Максимальный размер изображения: `4 MB`
  - Поддерживаемые форматы изображений: `JPG JPEG HEIC`
- Посты: 
  - Заголовок не должен превышать `300` символов 
  - Не более `10` изображений
  - Описание не более `5000` символов
  - Привязка поста к геопозиции и добавление описания геопозиции 
- Комментарии:
  - Размер комментария не более `1000` символов
  - Количество вложенных изображений не более `3`
- Лента:
  - Ранжирование по времени
- Подписки:
  - Ограничение на количество подписок `5000`
  - Ограничение на количество подписок в день `100`
- Приватные сообщения:
  - Размер сообщения не более `10000` символов
  - Количество вложенных изображений к сообщению не более `10`


## Оценка нагрузки (усредненные значения исходя из модели поведения пользователей) 

- 5% пользователей публикуют посты каждый день
    > RPS публикации постов = 10_000_000 * 0.05 / (24*3600) = `6`
    
    > Размер сообщения: 3_000_000 * 5 + 3000 * 2 + 200 * 2 + 64 * 2 = 15006528 bit = `1876` kb

- Каждый пользователь оставляет в среднем 10 оценок 
    > RPS реакций = 10_000_000 * 10 / (24*3600) = `1158`

    > Размер сообщения: 64 * 2 = 128 bit = `1` kb
    

- Каждый пользователь оставляет 2 комментария в день
    > RPS комментариев = 10_000_000 * 2 / (24*3600) = `232`

    > Размер сообщения: 3_000_000 + 1000 * 2 + 64 * 2 = `376` kb


- 15% пользователей взаимодействуют с подписками (подписка/отписка) каждый день
    > RPS подписок/отписок = 10_000_000 * 0.15 / (24*3600) = `18` 
    
    > Размер сообщения: 64 * 2 = `1` kb

- Каждый пользователь отправляет в среднем 5 сообщений в день
    > RPS приватных сообщений = 10_000_000 * 5 / (24*3600) = `579`

    > Размер сообщения: 3000 * 2 + 3_000_000 * 0.2 = `606` kb

- Каждый пользователь выполняет 3 поиска в день
    > RPS поиска = 10_000_000 * 3 / (24*3600) = `347`

    > Размер сообщения: 200 * 2 = `1` kb

- Каждый пользователь просматривает 10 лент
    > RPS лент = 10_000_000 * 10 / (24*3600) = `1158`

    > Размер сообщения: 64 * 2 = `1` kb


- Каждый пользователь просматривает 15 постов
    > RPS постов = 10_000_000 * 15 / (24*3600) = `1736`

    > Размер сообщения: 64 * 2 = `1` kb
  
### Трафик
> 1876 + 1 + 376 + 1 + 606 + 1 + 1 = 2862 kb

### Одновременные соединения

> 10_000_000 * 0.1 = 1_000_000




